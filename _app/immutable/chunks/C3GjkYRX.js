import{ac as c,e as a,ap as p}from"./sj7HJTey.js";function d(s,u,n){if(s==null)return u(void 0),c;const t=a(()=>s.subscribe(u,n));return t.unsubscribe?()=>t.unsubscribe():t}const i=[];function _(s,u=c){let n=null;const t=new Set;function o(r){if(p(s,r)&&(s=r,n)){const b=!i.length;for(const e of t)e[1](),i.push(e,s);if(b){for(let e=0;e<i.length;e+=2)i[e][0](i[e+1]);i.length=0}}}function f(r){o(r(s))}function l(r,b=c){const e=[r,b];return t.add(e),t.size===1&&(n=u(o,f)||c),r(s),()=>{t.delete(e),t.size===0&&n&&(n(),n=null)}}return{set:o,update:f,subscribe:l}}function h(s){let u;return d(s,n=>u=n)(),u}export{h as g,d as s,_ as w};
